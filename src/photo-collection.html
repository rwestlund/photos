<!--
    Copyright (c) 2016. Randy Westlund and Jacqueline Kory Westlund.
    All rights reserved.
    This code is under the BSD-2-Clause license.
-->

<link rel="import" href="../bower_components/polymer/polymer.html">

<dom-module id="photo-collection">
    <template>
        <style is="custom-style" include="app-grid-style"></style>
        <style>
            :host {
                display: block;
                    --app-grid-columns: 2;
                    --app-grid-gutter: 15px;
            }
            @media (max-width: 800px) {
                :host {
                    --app-grid-columns: 1;
                }
            }
        </style>

        <iron-ajax
            auto
            method="GET"
            url="/api/photos"
            params="[[search_filter]]"
            handle-as="json"
            last-response="{{photos}}">
        </iron-ajax>

        <template is="dom-if" if="[[!photos.length]]">
            <h4>This album has no photos!</h4>
        </template>

        <div class="app-grid">
            <template is="dom-repeat" items="[[photos]]">
                <photo-display photo="[[item]]"></photo-display>
            </template>
        </div>
    </template>

    <script>
        'use strict';
        Polymer({
            is: "photo-collection",
            properties: {
                tag: {
                    type: String,
                },
                search_filter: {
                    type: Object,
                    computed: "compute_search_filter(tag)",
                }
            },
            compute_search_filter: function(tag) {
                var o = {};
                if (tag) o.tag = tag;
                return o;
            },
            // Reevaluated the app-grid styles on resize.
            attached: function() {
                window.addEventListener("resize", () => this.updateStyles());
            },
        })
    </script>
</dom-module>
